
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://simonsobs.github.io/LAT_Alignment/4.0.0/reference/transforms/">
      
      
        <link rel="prev" href="../mirror/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>transforms - LAT_Alignment</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lat_alignment.transforms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="LAT_Alignment" class="md-header__button md-logo" aria-label="LAT_Alignment" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LAT_Alignment
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              transforms
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LAT_Alignment" class="md-nav__button md-logo" aria-label="LAT_Alignment" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    LAT_Alignment
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../adjustments/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    adjustments
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alignment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    alignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fitting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fitting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    io
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mirror/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mirror
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    transforms
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    transforms
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lat_alignment.transforms" class="md-nav__link">
    <span class="md-ellipsis">
      transforms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lat_alignment.transforms.align_photo" class="md-nav__link">
    <span class="md-ellipsis">
      align_photo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lat_alignment.transforms.coord_transform" class="md-nav__link">
    <span class="md-ellipsis">
      coord_transform
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lat_alignment.transforms" class="md-nav__link">
    <span class="md-ellipsis">
      transforms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lat_alignment.transforms.align_photo" class="md-nav__link">
    <span class="md-ellipsis">
      align_photo
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lat_alignment.transforms.coord_transform" class="md-nav__link">
    <span class="md-ellipsis">
      coord_transform
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>transforms</h1>

<div class="doc doc-object doc-module">



<a id="lat_alignment.transforms"></a>
    <div class="doc doc-contents first">

        <p>Functions for coordinate transforms.</p>
<p>There are 6 relevant coordinate systems here, belonging to two sets of three.
Each set is a global, a primary, and a secondary coordinate system;
where primary and secondary are internal to those mirrors.
The two sets of coordinates are the optical coordinates and the coordinates used
by vertex. We denote these six coordinate systems as follows:</p>
<pre><code>- opt_global
- opt_primary
- opt_secondary
- va_global
- va_primary
- va_secondary
</code></pre>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="lat_alignment.transforms.align_photo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">align_photo</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">mirror</span><span class="o">=</span><span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">reference</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Align photogrammetry data and then put it into mirror coordinates.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.str_">str_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The labels of each photogrammetry point.
Should have shape <code>(npoint,)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>coords</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float32">float32</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coordinates of each photogrammetry point.
Should have shape <code>(npoint, 3)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mirror</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The mirror that these points belong to.
Should be either: 'primary' or 'secondary'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;primary&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>reference</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[list[tuple[tuple[float, float, float], list[str]]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of reference points to use.
Each point given should be a tuple with two elements.
The first element is a tuple with the (x, y, z) coordinates
of the point in the global coordinate system.
The second is a list of nearby coded targets that can be used
to identify the point.
If <code>None</code> the default reference for each mirror is used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_dist</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Max distance in mm that the reference poing can be from the target
point used to locate it.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>labels</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.str_">str_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The labels of each photogrammetry point.
Invar points are not included.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>coords_transformed</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float32">float32</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The transformed coordinates.
Invar points are not included.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>msk</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.bool_">bool_</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mask to removes invar points</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lat_alignment/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">align_photo</span><span class="p">(</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span>
    <span class="n">coords</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">mirror</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;primary&quot;</span><span class="p">,</span>
    <span class="n">reference</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_dist</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Align photogrammetry data and then put it into mirror coordinates.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    labels : NDArray[np.str_]</span>
<span class="sd">        The labels of each photogrammetry point.</span>
<span class="sd">        Should have shape `(npoint,)`.</span>
<span class="sd">    coords : NDArray[np.float32]</span>
<span class="sd">        The coordinates of each photogrammetry point.</span>
<span class="sd">        Should have shape `(npoint, 3)`.</span>
<span class="sd">    mirror : str, default: &#39;primary&#39;</span>
<span class="sd">        The mirror that these points belong to.</span>
<span class="sd">        Should be either: &#39;primary&#39; or &#39;secondary&#39;.</span>
<span class="sd">    reference : Optional[list[tuple[tuple[float, float, float], list[str]]]], default: None</span>
<span class="sd">        List of reference points to use.</span>
<span class="sd">        Each point given should be a tuple with two elements.</span>
<span class="sd">        The first element is a tuple with the (x, y, z) coordinates</span>
<span class="sd">        of the point in the global coordinate system.</span>
<span class="sd">        The second is a list of nearby coded targets that can be used</span>
<span class="sd">        to identify the point.</span>
<span class="sd">        If `None` the default reference for each mirror is used.</span>
<span class="sd">    max_dist : float, default: 100</span>
<span class="sd">        Max distance in mm that the reference poing can be from the target</span>
<span class="sd">        point used to locate it.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    labels : NDArray[np.str_]</span>
<span class="sd">        The labels of each photogrammetry point.</span>
<span class="sd">        Invar points are not included.</span>
<span class="sd">    coords_transformed : NDArray[np.float32]</span>
<span class="sd">        The transformed coordinates.</span>
<span class="sd">        Invar points are not included.</span>
<span class="sd">    msk : NDArray[np.bool_]</span>
<span class="sd">        Mask to removes invar points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">mirror</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;primary&quot;</span><span class="p">,</span> <span class="s2">&quot;secondary&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid mirror: </span><span class="si">{</span><span class="n">mirror</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mirror</span> <span class="o">==</span> <span class="s2">&quot;primary&quot;</span><span class="p">:</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">coord_transform</span><span class="p">,</span> <span class="n">cfrom</span><span class="o">=</span><span class="s2">&quot;va_global&quot;</span><span class="p">,</span> <span class="n">cto</span><span class="o">=</span><span class="s2">&quot;opt_primary&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">coord_transform</span><span class="p">,</span> <span class="n">cfrom</span><span class="o">=</span><span class="s2">&quot;va_global&quot;</span><span class="p">,</span> <span class="n">cto</span><span class="o">=</span><span class="s2">&quot;opt_secondary&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reference</span> <span class="o">=</span> <span class="n">DEFAULT_REF</span><span class="p">[</span><span class="n">mirror</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">reference</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">reference</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid or empty reference&quot;</span><span class="p">)</span>

    <span class="c1"># Lets find the points we can use</span>
    <span class="n">trg_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">char</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="s2">&quot;TARGET&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">invars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">rpoint</span><span class="p">,</span> <span class="n">codes</span> <span class="ow">in</span> <span class="n">reference</span><span class="p">:</span>
        <span class="n">have</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">codes</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">have</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">coded</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">labels</span> <span class="o">==</span> <span class="n">codes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">have</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">codes</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">have</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
        <span class="c1"># Find the closest point</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="n">trg_idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">coded</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_dist</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dist</span><span class="p">))</span>
        <span class="n">ref</span> <span class="o">+=</span> <span class="p">[</span><span class="n">rpoint</span><span class="p">]</span>
        <span class="n">pts</span> <span class="o">+=</span> <span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="n">trg_idx</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist</span><span class="p">)]]</span>
        <span class="n">invars</span> <span class="o">+=</span> <span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">trg_idx</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dist</span><span class="p">)]]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Only </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="si">}</span><span class="s2"> reference points found! Can&#39;t align!&quot;</span><span class="p">)</span>
    <span class="n">msk</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">pts</span><span class="p">)[</span><span class="n">msk</span><span class="p">]</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">ref</span><span class="p">)[</span><span class="n">msk</span><span class="p">]</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">pts</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">ref</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">transform</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reference points in mirror coords:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ref</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">make_edm</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">/</span> <span class="n">make_edm</span><span class="p">(</span><span class="n">pts</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">make_edm</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">-</span> <span class="n">make_edm</span><span class="p">(</span><span class="n">pts</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">make_edm</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">/</span> <span class="n">make_edm</span><span class="p">(</span><span class="n">pts</span><span class="p">)))</span>
    <span class="n">pts</span> <span class="o">*=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">make_edm</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">/</span> <span class="n">make_edm</span><span class="p">(</span><span class="n">pts</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">make_edm</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">/</span> <span class="n">make_edm</span><span class="p">(</span><span class="n">pts</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">make_edm</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">-</span> <span class="n">make_edm</span><span class="p">(</span><span class="n">pts</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="n">make_edm</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span> <span class="o">/</span> <span class="n">make_edm</span><span class="p">(</span><span class="n">pts</span><span class="p">)))</span>

    <span class="n">rot</span><span class="p">,</span> <span class="n">sft</span> <span class="o">=</span> <span class="n">get_rigid</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
    <span class="n">pts_t</span> <span class="o">=</span> <span class="n">apply_transform</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">sft</span><span class="p">)</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pts_t</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pts_t</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ref</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ref</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pts_t</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pts_t</span> <span class="o">-</span> <span class="n">ref</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;RMS of reference points after alignment: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">pts_t</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ref</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">coords_transformed</span> <span class="o">=</span> <span class="n">apply_transform</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">sft</span><span class="p">)</span>

    <span class="n">msk</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">invars</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">labels</span><span class="p">[</span><span class="n">msk</span><span class="p">],</span> <span class="n">coords_transformed</span><span class="p">[</span><span class="n">msk</span><span class="p">],</span> <span class="n">msk</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="lat_alignment.transforms.coord_transform" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">coord_transform</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">cfrom</span><span class="p">,</span> <span class="n">cto</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Transform between the six defined mirror coordinates:</p>
<pre><code>- opt_global
- opt_primary
- opt_secondary
- va_global
- va_primary
- va_secondary
</code></pre>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>coords</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float32">float32</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinates to transform.
Should be a <code>(npoint, 3)</code> array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cfrom</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coordinate system that <code>coords</code> is currently in.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cto</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The coordinate system to put <code>coords</code> into.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>coords_transformed</code></td>            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float32">float32</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>coords</code> transformed into <code>cto</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lat_alignment/transforms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">coord_transform</span><span class="p">(</span>
    <span class="n">coords</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">],</span> <span class="n">cfrom</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cto</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Transform between the six defined mirror coordinates:</span>

<span class="sd">        - opt_global</span>
<span class="sd">        - opt_primary</span>
<span class="sd">        - opt_secondary</span>
<span class="sd">        - va_global</span>
<span class="sd">        - va_primary</span>
<span class="sd">        - va_secondary</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coords : NDArray[np.float32]</span>
<span class="sd">        Coordinates to transform.</span>
<span class="sd">        Should be a `(npoint, 3)` array.</span>
<span class="sd">    cfrom : str</span>
<span class="sd">        The coordinate system that `coords` is currently in.</span>
<span class="sd">    cto : str</span>
<span class="sd">        The coordinate system to put `coords` into.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    coords_transformed : NDArray[np.float32]</span>
<span class="sd">        `coords` transformed into `cto`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cfrom</span> <span class="o">==</span> <span class="n">cto</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">coords</span>
    <span class="k">match</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfrom</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">cto</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span>
        <span class="k">case</span> <span class="s2">&quot;opt_global-opt_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_global_to_opt_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_global-opt_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_global_to_opt_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_primary-opt_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_primary_to_opt_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_secondary-opt_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_secondary_to_opt_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_primary-opt_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_primary_to_opt_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_secondary-opt_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_secondary_to_opt_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_global-va_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_global_to_va_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_global-va_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_global_to_va_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_primary-va_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_primary_to_va_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_secondary-va_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_secondary_to_va_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_primary-va_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_primary_to_va_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_secondary-va_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_secondary_to_va_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_global-va_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_global_to_va_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_global-va_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_global_to_va_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_global-va_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_global_to_va_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_primary-va_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_primary_to_va_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_primary-va_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_primary_to_va_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_primary-va_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_primary_to_va_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_secondary-va_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_secondary_to_va_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_secondary-va_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_secondary_to_va_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;opt_secondary-va_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_opt_secondary_to_va_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_global-opt_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_global_to_opt_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_global-opt_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_global_to_opt_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_global-opt_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_global_to_opt_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_primary-opt_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_primary_to_opt_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_primary-opt_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_primary_to_opt_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_primary-opt_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_primary_to_opt_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_secondary-opt_global&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_secondary_to_opt_global</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_secondary-opt_primary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_secondary_to_opt_primary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span> <span class="s2">&quot;va_secondary-opt_secondary&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_va_secondary_to_opt_secondary</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid coordinate system provided!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>